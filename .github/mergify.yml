pull_request_rules:
  - name: Backport to main
    conditions:
      - label=backport-to-main
    actions:
      backport:
        branches:
          - main
        assignees:
          - "{{ author }}"
        labels:
          - backport
          - main

  - name: Backport to 2022
    conditions:
      - or:
        - label=backport-to-all
        - label=backport-to-2022
    actions:
      backport:
        branches:
          - "2022"
        assignees:
          - "{{ author }}"
        labels:
          - backport
          - "2022"

  - name: Backport to 2021
    conditions:
      - or:
        - label=backport-to-all
        - label=backport-to-2021
    actions:
      backport:
        branches:
          - "2021"
        assignees:
          - "{{ author }}"
        labels:
          - backport
          - "2021"

  - name: Backport to 2020
    conditions:
      - or:
        - label=backport-to-all
        - label=backport-to-2020
    actions:
      backport:
        branches:
          - "2020"
        assignees:
          - "{{ author }}"
        labels:
          - backport
          - "2020"

  - name: Backport to 2019
    conditions:
      - or:
        - label=backport-to-all
        - label=backport-to-2019
    actions:
      backport:
        branches:
          - "2019"
        assignees:
          - "{{ author }}"
        labels:
          - backport
          - "2019"

  - name: Backport to 2018
    conditions:
      - or:
        - label=backport-to-all
        - label=backport-to-2018
    actions:
      backport:
        branches:
          - "2018"
        assignees:
          - "{{ author }}"
        labels:
          - backport
          - "2018"

  - name: Backport to 2017
    conditions:
      - or:
        - label=backport-to-all
        - label=backport-to-2017
    actions:
      backport:
        branches:
          - "2017"
        assignees:
          - "{{ author }}"
        labels:
          - backport
          - "2017"

  - name: Backport to 2016
    conditions:
      - or:
        - label=backport-to-all
        - label=backport-to-2016
    actions:
      backport:
        branches:
          - "2016"
        assignees:
          - "{{ author }}"
        labels:
          - backport
          - "2016"

  - name: Auto merge backport pull request
    conditions:
      - and:
        - label=backport
        - label!=conflicts
        - title~=[\w\W]+?\(backport \#\d+?\)
    actions:
      merge:
        method: squash

  - name: Auto merge translation pull request
    conditions:
      - and:
        - label=translation
        - label!=conflicts
        - title~=Update translations \(\d+\/\d+\/\d+\)
    actions:
      merge:
        method: squash

  - name: Auto merge updating version number pull request
    conditions:
      - and:
        - label=version
        - label!=conflicts
        - title~=Update release version \(\d+\/\d+\/\d+\)
    actions:
      merge:
        method: squash

  - name: Auto merge updating docs pull request
    conditions:
      - and:
        - label=docs
        - label!=conflicts
        - title~=Update docs \(\w+, \d+\/\d+\/\d+\)
    actions:
      merge:
        method: squash

  - name: Warn on conflicts
    conditions:
      - conflict
    actions:
      comment:
        message: "@{{author}} this pull request is now in conflicts ðŸ˜©"
      label:
        add:
          - conflicts

  - name: Add comment on documentation preview
    conditions:
      - label=docs-preview
    actions:
      comment:
        message: |
          This pull request is now in preview on https://haiiliin.com/abqpy/.
